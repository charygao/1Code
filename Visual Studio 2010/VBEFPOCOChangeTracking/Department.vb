'------------------------------------------------------------------------------
' <auto-generated>
'     This code was generated from a template.
'
'     Changes to this file may cause incorrect behavior and will be lost if
'     the code is regenerated.
' </auto-generated>
'------------------------------------------------------------------------------
Imports System
Imports System.Collections
Imports System.Collections.Generic
Imports System.Collections.ObjectModel
Imports System.Collections.Specialized

Partial Public Class Department
    #Region "Primitive Properties"

    Public Overridable Property DepartmentID As Integer

    Public Overridable Property Name As String

    Public Overridable Property Budget As Nullable(Of Decimal)

    Public Overridable Property StartDate As Nullable(Of Date)

    Public Overridable Property Administrator As Nullable(Of Integer)

    #End Region
    #Region "Navigation Properties"
    Public Overridable Property Courses As ICollection(Of Course)
        Get
            If _courses Is Nothing Then
                Dim newCollection As New FixupCollection(Of Course)
                AddHandler newCollection.CollectionChanged, AddressOf FixupCourses
                _courses = newCollection
            End If
            Return _courses
        End Get
        Set(ByVal value As ICollection(Of Course))
            If _courses IsNot value Then
                Dim previousValue As FixupCollection(Of Course) = TryCast(_courses, FixupCollection(Of Course))
                If previousValue IsNot Nothing Then
                    RemoveHandler previousValue.CollectionChanged, AddressOf FixupCourses
                End If
                _courses = value
                Dim newValue As FixupCollection(Of Course) = TryCast(value, FixupCollection(Of Course))
                If newValue IsNot Nothing Then
                    AddHandler newValue.CollectionChanged, AddressOf FixupCourses
                End If
            End If
        End Set
    End Property
    Private _courses As ICollection(Of Course)

    #End Region
    #Region "Association Fixup"
    Private Sub FixupCourses(ByVal sender As Object, ByVal e As NotifyCollectionChangedEventArgs)
        If e.NewItems IsNot Nothing Then
            For Each item As Course In e.NewItems
                item.Department = Me
            Next
        End If
        If e.OldItems IsNot Nothing Then
            For Each item As Course In e.OldItems
                If item.Department Is Me Then
                    item.Department = Nothing
                End If
            Next
        End If
    End Sub

    #End Region
End Class
